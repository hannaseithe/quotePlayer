<div class="app-all-quotes">
  <mat-accordion id="quote-accordion" displayMode="flat">

    <mat-expansion-panel class="mat-expansion-panel-1" [expanded]="panelOpenState" (closed)="panelOpenState = false"
      (opened)="panelOpenState = true">
      <mat-expansion-panel-header>
        <mat-panel-title>
          <button mat-button (click)="chooseOption(true); $event.stopPropagation()" [class.active]="panelOpenState && quoteSelected">Add
            a new Quote</button>
          <button mat-button (click)="chooseOption(false); $event.stopPropagation()" [class.active]="panelOpenState && !quoteSelected">Import
            Quotes from Excel File</button>
        </mat-panel-title>
      </mat-expansion-panel-header>
      <div *ngIf="quoteSelected">
        <app-quote [quote]="editElement"></app-quote>
      </div>
      <div *ngIf="!quoteSelected">
        <mat-form-field class="button">
          <ngx-mat-file-input [formControl]="excelFile" placeholder="Select Excel File to Import" accept=".xls, .xlsx"></ngx-mat-file-input>
          <mat-icon matSuffix>folder</mat-icon>
        </mat-form-field>
        <button class="left-margin" mat-raised-button color="accent" (click)='importExcel()' [disabled]="excelFile.pristine || excelFile.untouched || excelFile.invalid">Import
          Quotes from Excel
          <mat-spinner class="custom-spinner" *ngIf="importInProgress" [diameter]="25"></mat-spinner>
        </button>
        <mde-popover #appPopover="mdePopover" [mdePopoverOverlapTrigger]="false" mdePopoverTriggerOn="click" [mdePopoverCloseOnClick]="true">
          <mat-card>
            <mat-card-title>
              How to import Quotes from an Excel File
            </mat-card-title>
            <mat-card-content>
              <p>1. Click on the folder Icon and then choose the excel file you want to import from your computer.</p>
              <p>2. Click on the enabled "Import Quotes from Excel" Button (next to the folder icon)</p>
              <p>The file can contain only one table and that table has to follow certain specifications</p>
                <p>(otherwise the "Quote Player" wont be able to interpret the data correctly).</p>
              <ul>
                <li>the first row (1) has to contain four fields (from A to D) with the EXACT words:<br />
                  quote | author | source | tags
                </li>
                <li>each quote is entered in a new row (e.g. row 2:A-D)</li>
                <li>the quote column always has to be filled out, the other columns are optional</li>
                <li>if you want to add more than one tag for one quote, you have to seperate the tags by "," - e.g.
                  "responsibility, vision"</li>
              </ul>

              <p>Here is a screenshot of an example Excel File:</p>
              <img src="/app2/assets/img/excel-example.png" width="500px" alt="Image could not be found, please make a bug report">

            </mat-card-content>
          </mat-card>
        </mde-popover>

        <button mat-icon-button [mdePopoverTriggerFor]="appPopover">
          <mat-icon>info</mat-icon>
        </button>
      </div>
    </mat-expansion-panel>

  </mat-accordion>
  <mat-divider></mat-divider>
  <app-quotes-table (editQuote)="setEditQuote($event)" editColumn="true"></app-quotes-table>



</div>